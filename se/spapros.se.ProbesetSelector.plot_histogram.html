<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>spapros.se.ProbesetSelector.plot_histogram &mdash; spapros docs</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom_cookietemple.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/general.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/dark.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/logo.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
        <script src="../_static/dark_mode_js/default_light.js"></script>
        <script src="../_static/dark_mode_js/theme_switcher.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="spapros.se.ProbesetSelector.select_probeset" href="spapros.se.ProbesetSelector.select_probeset.html" />
    <link rel="prev" title="spapros.se.ProbesetSelector.plot_gene_overlap" href="spapros.se.ProbesetSelector.plot_gene_overlap.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> spapros
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">CONTENTS:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#module-spapros.se">Selection</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="spapros.se.ProbesetSelector.html">spapros.se.ProbesetSelector</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="spapros.se.ProbesetSelector.info.html">spapros.se.ProbesetSelector.info</a></li>
<li class="toctree-l4"><a class="reference internal" href="spapros.se.ProbesetSelector.plot_clf_genes.html">spapros.se.ProbesetSelector.plot_clf_genes</a></li>
<li class="toctree-l4"><a class="reference internal" href="spapros.se.ProbesetSelector.plot_coexpression.html">spapros.se.ProbesetSelector.plot_coexpression</a></li>
<li class="toctree-l4"><a class="reference internal" href="spapros.se.ProbesetSelector.plot_explore_constraint.html">spapros.se.ProbesetSelector.plot_explore_constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="spapros.se.ProbesetSelector.plot_gene_overlap.html">spapros.se.ProbesetSelector.plot_gene_overlap</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">spapros.se.ProbesetSelector.plot_histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="spapros.se.ProbesetSelector.select_probeset.html">spapros.se.ProbesetSelector.select_probeset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spapros.se.select_reference_probesets.html">spapros.se.select_reference_probesets</a></li>
<li class="toctree-l3"><a class="reference internal" href="spapros.se.select_pca_genes.html">spapros.se.select_pca_genes</a></li>
<li class="toctree-l3"><a class="reference internal" href="spapros.se.select_DE_genes.html">spapros.se.select_DE_genes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-spapros.ev">Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-spapros.ut">Utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#plotting">Plotting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Contributor Covenant Code of Conduct</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">spapros</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">API</a> &raquo;</li>
          <li><a href="spapros.se.ProbesetSelector.html">spapros.se.ProbesetSelector</a> &raquo;</li>
      <li>spapros.se.ProbesetSelector.plot_histogram</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/se/spapros.se.ProbesetSelector.plot_histogram.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="spapros-se-probesetselector-plot-histogram">
<h1>spapros.se.ProbesetSelector.plot_histogram<a class="headerlink" href="#spapros-se-probesetselector-plot-histogram" title="Permalink to this heading"></a></h1>
<dl class="py method">
<dt class="sig sig-object py" id="spapros.se.ProbesetSelector.plot_histogram">
<span class="sig-prename descclassname"><span class="pre">ProbesetSelector.</span></span><span class="sig-name descname"><span class="pre">plot_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_axis_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalty_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unapplied_penalty_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spapros.se.ProbesetSelector.plot_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Plot histograms of (basic) selections under given penalties.</p>
<p>The full selection procedure consists of steps partially based on basic score based selection procedures.
This is an interactive plotting function to investigate if the constructed penalty kernels are well chosen.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The green line shows a linear interpolation of the penalty scores which is only an approximation of the
penalty function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_axis_keys</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – Dictionary with the values from <code class="docutils literal notranslate"><span class="pre">penaly_keys</span></code> as keys and the column name of <code class="docutils literal notranslate"><span class="pre">adata.var</span></code> that was
used to calcuate the respective penalty factors.</p></li>
<li><p><strong>selections</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>Literal</em><em>[</em><em>'pca'</em><em>, </em><em>'DE'</em><em>, </em><em>'marker'</em><em>]</em><em>]</em><em>]</em>) – <p>Plot the histograms of selections based on</p>
<blockquote>
<div><ul>
<li><p><cite>’pca’</cite> : pca loadings based selection of prior genes</p></li>
<li><p><cite>’DE’</cite> : genes selected based on differential expressed which are used as the
<cite>‘forest_DE_baseline’</cite></p></li>
<li><p><cite>’marker’</cite> : genes from the marker list</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>penalty_keys</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>]</em>) – <p>Dictionary with the selection method name as key and the name of the column for <code class="docutils literal notranslate"><span class="pre">adata.var</span></code> containing
the penalty factors to plot. Selections that are not in <code class="docutils literal notranslate"><span class="pre">penalty_keys</span></code> are plottet without penalty.
If <cite>None</cite> (default), we use the columns defined in the selector for each selection. The respective
attributes of the selector are:</p>
<blockquote>
<div><ul>
<li><p><cite>’pca’</cite>: <code class="xref py py-attr docutils literal notranslate"><span class="pre">pca_penalties</span></code></p></li>
<li><p><cite>’DE’</cite>: <code class="xref py py-attr docutils literal notranslate"><span class="pre">DE_penalties</span></code></p></li>
<li><p><cite>’marker’</cite>: <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_penalties_adata_celltypes</span></code></p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>unapplied_penalty_keys</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>]</em>) – Same as <code class="docutils literal notranslate"><span class="pre">penalty_keys</span></code> but for penalties that were not applied to the selection.</p></li>
<li><p><strong>background_key</strong> (<em>Union</em><em>[</em><em>bool</em><em>, </em><em>str</em><em>]</em>) – Key in <code class="docutils literal notranslate"><span class="pre">adata.var</span></code> for preselected genes (typically <cite>‘highly_variable_genes’</cite>) to plot as background
histogram . If <cite>True</cite> (default), <code class="xref py py-attr docutils literal notranslate"><span class="pre">g_key</span></code> is used. If <cite>None</cite> no background is plottet. If <cite>‘all’</cite>, all genes
are used as background.</p></li>
<li><p><strong>kwargs</strong> – Further arguments for <a class="reference internal" href="../pl/spapros.pl.selection_histogram.html#spapros.pl.selection_histogram" title="spapros.pl.selection_histogram"><code class="xref py py-func docutils literal notranslate"><span class="pre">selection_histogram()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure can be showed (default <cite>True</cite>) and stored to path (default <cite>None</cite>).
Change this with <cite>show</cite> and <cite>save</cite> in <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="spapros.se.ProbesetSelector.plot_gene_overlap.html" class="btn btn-neutral float-left" title="spapros.se.ProbesetSelector.plot_gene_overlap" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spapros.se.ProbesetSelector.select_probeset.html" class="btn btn-neutral float-right" title="spapros.se.ProbesetSelector.select_probeset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Lukas Heumos.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>